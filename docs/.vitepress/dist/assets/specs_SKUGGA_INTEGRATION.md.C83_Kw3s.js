import{_ as a,o as i,c as e,ae as t}from"./chunks/framework.BD9pLfSD.js";const c=JSON.parse('{"title":"Skugga Integration: Automated Mock Verification","description":"","frontmatter":{},"headers":[],"relativePath":"specs/SKUGGA_INTEGRATION.md","filePath":"specs/SKUGGA_INTEGRATION.md"}'),n={name:"specs/SKUGGA_INTEGRATION.md"};function l(h,s,p,k,o,r){return i(),e("div",null,[...s[0]||(s[0]=[t(`<h1 id="skugga-integration-automated-mock-verification" tabindex="-1">Skugga Integration: Automated Mock Verification <a class="header-anchor" href="#skugga-integration-automated-mock-verification" aria-label="Permalink to &quot;Skugga Integration: Automated Mock Verification&quot;">​</a></h1><p>Prova supports optional integration with <strong>Skugga</strong>, an AOT mocking library. This integration allows for automated mock verification without adding a hard runtime dependency.</p><h2 id="mock-verification-automation" tabindex="-1">Mock Verification Automation <a class="header-anchor" href="#mock-verification-automation" aria-label="Permalink to &quot;Mock Verification Automation&quot;">​</a></h2><p>Prova uses compile-time heuristics to detect mock objects within test classes and automate their verification lifecycle.</p><h3 id="loose-coupling" tabindex="-1">Loose Coupling <a class="header-anchor" href="#loose-coupling" aria-label="Permalink to &quot;Loose Coupling&quot;">​</a></h3><p>The Prova binaries do not reference Skugga. The integration is activated via source generation only when Skugga types are detected in the user&#39;s codebase.</p><h3 id="detection-logic" tabindex="-1">Detection Logic <a class="header-anchor" href="#detection-logic" aria-label="Permalink to &quot;Detection Logic&quot;">​</a></h3><p>During the source generation phase, Prova:</p><ol><li>Scans for fields within the test class.</li><li>Checks if a field&#39;s type name contains <code>&quot;Skugga&quot;</code> or <code>&quot;Mock&lt;&quot;</code>.</li><li>If detected, Prova generates a <code>finally</code> block that invokes <code>.VerifyAll()</code> on the mock instance at the end of each test method execution.</li></ol><h2 id="usage-example" tabindex="-1">Usage Example <a class="header-anchor" href="#usage-example" aria-label="Permalink to &quot;Usage Example&quot;">​</a></h2><p>To enable automated verification, define mocks as fields in the test class.</p><h3 id="_1-install-dependencies" tabindex="-1">1. Install Dependencies <a class="header-anchor" href="#_1-install-dependencies" aria-label="Permalink to &quot;1. Install Dependencies&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Prova</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Skugga</span></span></code></pre></div><h3 id="_2-implementation" tabindex="-1">2. Implementation <a class="header-anchor" href="#_2-implementation" aria-label="Permalink to &quot;2. Implementation&quot;">​</a></h3><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Prova</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Skugga</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PaymentTests</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Prova detects this field and generates a call to _paymentGateway.VerifyAll()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // at the end of every test method in this class.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> readonly</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Mock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IPaymentGateway</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_paymentGateway</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Mock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IPaymentGateway</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Fact</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Charge_CallsGateway</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PaymentProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_paymentGateway.Object);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        processor.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Process</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Manual verification is not required.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // If expectation was not met, the test will fail during teardown.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">​</a></h2><ul><li><strong>Skugga Repository</strong>: <a href="https://github.com/Digvijay/Skugga" target="_blank" rel="noreferrer">https://github.com/Digvijay/Skugga</a></li></ul>`,17)])])}const g=a(n,[["render",l]]);export{c as __pageData,g as default};
